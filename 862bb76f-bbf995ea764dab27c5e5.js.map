{"version":3,"file":"862bb76f-bbf995ea764dab27c5e5.js","mappings":"k/CAiBMA,EAAe,SAAfA,EAAgB,GAIf,IAAD,IAHJC,EAGI,EAHJA,SACAC,EAEI,EAFJA,SACAC,EACI,EADJA,cAEA,GAAsEC,EAAAA,EAAAA,YAAWC,EAAAA,GAAzEC,EAAR,EAAQA,kBAAyCC,EAAjD,EAA2BC,qBACrBC,EAAkBH,EAExB,GAA8CI,EAAAA,EAAAA,YAAvCC,EAAP,KAAwBC,EAAxB,KACA,GAA4CF,EAAAA,EAAAA,UAAS,IAA9CG,EAAP,KAAwBC,EAAxB,KAEMC,EAAqB,CAAC,EACtBC,EAAc,CAAEC,MAAO,WAAYC,YAAa,IAEtDT,SAAA,UAAAA,EAAkBT,UAAlB,SAAiCmB,SAASC,SAAQ,YAAsB,IAEpB,EAMJ,EARKC,EAAkB,EAAlBA,KAAMC,EAAY,EAAZA,OACzDP,EAAmBM,GAAQC,EACvBA,EAAMH,UAAYE,IAASE,EAAAA,KAC7BR,EAAmBM,GAAQC,EAC3BA,SAAA,UAAAA,EAAOH,gBAAP,SAAiBC,SAAQ,YAAsB,IAAnBC,EAAkB,EAAlBA,KAAMC,EAAY,EAAZA,MAChCP,EAAmBM,GAAQC,CAC5B,KAECD,IAASG,EAAAA,IAATH,MAAyBC,GAAAA,EAAOH,WAClC,EAAAH,EAAYE,aAAYO,KAAxB,gBACK,GAAGC,OAAOJ,EAAMH,UAAUQ,KAAI,oBAAGL,MAAH,MAAiC,CAAEL,MAAnC,EAAYA,MAA8BW,KAA1C,EAAmBA,KAAnB,KAGtC,IACD,IAAMC,EAAUb,aAAH,EAAGA,EAAaE,aAE7BY,EAAAA,EAAAA,YAAU,WACJ7B,EAAQ,WACV8B,EAAY,+BACoBxB,aADrB,EACqBA,EAAkByB,IADvC,aACsD9B,EAAS+B,UAD/D,eACuF/B,EAASgC,YADhG,YAETjC,EAAQ,SACRA,EAAQ,OAGb,GAAE,IAEH,IAAMkC,EAAO1B,aAAH,EAAGA,EAAkBT,GAEzB+B,EAAW,mCAAG,WAAOK,EAAaC,EAAuBC,GAA3C,+GAAoBD,IAAAA,EAAW,YACjDzB,GAAmB,GADD,kBAGM2B,IAAAA,iBAA4BD,GAHlC,cAGVE,EAHU,OAIVC,EAAiB,IAAIC,WAAWF,GAASG,OACzCC,EAAM,IAAIC,KALA,UAOVD,EAAIE,UAAUL,GAPJ,eASVM,EATU,UASFC,OAAOC,gBATL,iBASF,EAAiBC,6BATf,aASF,EAAwCH,MAChDI,EAAU,CACdC,OAAQ,MACRC,QAAS,CACP,eAAgB,mBAChBC,cAAe,UAAYP,EAC3B,sBAAaC,cAAb,iBAAa,EAAQC,gBAArB,iBAAa,EAAkBM,mBAA/B,aAAa,EAA+BC,YAfhC,UAmBOC,MAAMrB,EAAae,GAnB1B,WAqBQ,OAFlBjD,EAnBU,QAqBHwD,OArBG,kCAsBWxD,EAASyD,OAtBpB,eAsBRC,EAtBQ,OAwBdhB,EAAIiB,KAAK,kBAAmBC,KAAKC,UAAUH,IAxB7B,UA0BgBhB,EAAIoB,cAAc,CAAE3C,KAAM,SA1B1C,QA0BR4C,EA1BQ,QA2BdC,EAAAA,EAAAA,QAAOD,EAAoB5B,EAArB,QA3BQ,wBA6Bd8B,QAAQC,MAAM,oDAAqDlE,EAASwD,QA7B9D,0DAgChBS,QAAQC,MAAM,qBAAd,MAhCgB,yBAkChBxD,GAAmB,GAlCH,6EAAH,0DAsCjB,OACE,cACEyD,UAAWC,IAAWnC,aAAD,EAACA,EAAMkC,WAC5BE,IAAG,IAKH,cACEF,UAAWC,IAAWnC,aAAD,EAACA,EAAMkC,WAC5BE,KAAKA,EAAAA,EAAAA,IAAF,gKAS+BC,EAAAA,GAT/B,qBASoEC,EAAAA,GATpE,iCAcH,cACEF,IAAG,IAKFpC,aAAA,EAAAA,EAAMuC,SACL,aACEL,UAAU,2CACVE,IAAG,GAIFpC,aANH,EAMGA,EAAMuC,OAGV/D,IACC,cACE4D,IAAG,IAMH,cAAKF,UAAU,kGACb,cAAKA,UAAU,mCACf,cAAKA,UAAU,kCACb,cAAKA,UAAU,sCACb,cAAKA,UAAU,yCACb,cAAKA,UAAU,oCAGnB,cAAKA,UAAU,sCACb,cAAKA,UAAU,yCACb,cAAKA,UAAU,sCAKvB,YACEE,IAAG,GADL,oBASLtE,EAAQ,YAAiBkC,aAAzB,EAAyBA,EAAMwC,aAC9B,YACEN,UAAU,qCACVE,IAAG,GAGFpC,aALH,EAKGA,EAAMwC,WAGV1E,EAAQ,YACP,YACEoE,UAAU,qCACVE,IAAG,GAFL,yBAME,iBACEA,IAAG,EAaHK,QAAS,kBACP7C,EAAY,+BACoBxB,aADrB,EACqBA,EAAkByB,IADvC,aACsD9B,EAAS+B,UAD/D,eACuF/B,EAASgC,YADhG,YAETjC,EAAQ,SACRA,EAAQ,OAJH,EAOT,UAAQ,oBArBV,uBA2BN,cACEsE,KAAKA,EAAAA,EAAAA,IAAF,uDAI+BC,EAAAA,GAJ/B,qBAIoEC,EAAAA,GAJpE,iDASH,cACEF,KAAKA,EAAAA,EAAAA,IAAF,uFAM+BC,EAAAA,GAN/B,qBAMoEC,EAAAA,GANpE,uBAUH,OAAC,IAAD,CACEI,eAAgB5E,EAAQ,eACxBiB,YAAaW,EACbiD,iBAAkBtD,EAAAA,GAClBuD,qBAAsBC,EAAAA,EACtBC,wBAAyBC,EAAAA,EACzBC,uBAAwB5D,EAAAA,EACxB6D,sBAAuBnF,EAAQ,eAC/BM,iBAAkBA,EAClBL,SAAUA,EACVmF,eAAgBlD,aAAF,EAAEA,EAAMmD,cACtBC,gBAAiBpD,aAAF,EAAEA,EAAMqD,eACvBC,eAAgBtD,aAAF,EAAEA,EAAMuD,oBACtBC,uBAAwBxD,aAAF,EAAEA,EAAMwD,uBAC9B5E,mBAAoBA,KAEtB,cACEwD,IAAG,IAMH,aACEF,UAAU,4CACVE,IAAG,GAFL,4BAQA,YAAGF,UAAU,uCACX,iBACEO,QAASzE,EACToE,IAAG,EAWA,UAAQ,0BAbb,0CAmBLpC,SAAAA,EAAMhB,UACL,OAAC,IAAD,CACEyE,YAAW,UAAE7E,EAAmB8E,EAAAA,UAArB,aAAE,EAAmC1E,SAChD2E,SAAUD,EAAAA,IAEV,MAELhF,IACC,OAAC,IAAD,CACEkF,QAAQ,UACRC,QAAQ,sBACRC,QAAS,IACTC,sBAAuBpF,IAKhC,C","sources":["webpack://analytics-2.0-apis/./node_modules/@adobe/gatsby-theme-aio/src/components/GetCredential/MyCredential.js"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react';\r\nimport { css } from '@emotion/react';\r\nimport classNames from 'classnames';\r\nimport JSZip from 'jszip';\r\nimport JSZipUtils from 'jszip-utils';\r\nimport { saveAs } from 'file-saver';\r\nimport { MAX_TABLET_SCREEN_WIDTH, MIN_MOBILE_WIDTH } from './FormFields';\r\nimport { Toast } from '../Toast';\r\nimport { CardProducts } from './Products';\r\nimport { SideComponent } from './SideComponent';\r\nimport { AccessToken } from './Card/AccessToken';\r\nimport { DevConsoleLink } from './Card/DevConsoleLink';\r\nimport { CardClientDetails } from './Card/CardClientDetails';\r\nimport { SideContent } from './Form/SideContent';\r\nimport GetCredentialContext from './GetCredentialContext';\r\nimport { CredentialDetailsCard } from './CredentialDetailsCard';\r\n\r\nconst MyCredential = ({\r\n  formData,\r\n  response,\r\n  handleRestart\r\n}) => {\r\n  const { getCredentialData, selectedOrganization: organizationName } = useContext(GetCredentialContext);\r\n  const credentialProps = getCredentialData;\r\n\r\n  const [isDownloadStart, setIsDownloadStart] = useState();\r\n  const [isCopiedTooltip, setCopiedTooltip] = useState('');\r\n\r\n  const myCredentialFields = {};\r\n  const productsObj = { label: 'products', productList: [] };\r\n\r\n  credentialProps?.[MyCredential]?.children.forEach(({ type, props }) => {\r\n    myCredentialFields[type] = props;\r\n    if (props.children && type === CardClientDetails) {\r\n      myCredentialFields[type] = props;\r\n      props?.children?.forEach(({ type, props }) => {\r\n        myCredentialFields[type] = props;\r\n      });\r\n    }\r\n    if (type === CardProducts && props?.children) {\r\n      productsObj.productList.push(\r\n        ...[].concat(props.children).map(({ props: { label, icon } }) => ({ label, icon }))\r\n      );\r\n    }\r\n  });\r\n  const product = productsObj?.productList;\r\n\r\n  useEffect(() => {\r\n    if (formData['Downloads']) {\r\n      downloadZIP(\r\n        `/console/api/organizations/${organizationName?.id}/projects/${response.projectId}/workspaces/${response.workspaceId}/download`,\r\n        formData['Download'],\r\n        formData['zipUrl']\r\n      );\r\n    }\r\n  }, []);\r\n\r\n  const card = credentialProps?.[MyCredential];\r\n\r\n  const downloadZIP = async (downloadAPI, fileName = 'download', zipFileURL) => {\r\n    setIsDownloadStart(true);\r\n    try {\r\n      const zipData = await JSZipUtils.getBinaryContent(zipFileURL);\r\n      const zipArrayBuffer = new Uint8Array(zipData).buffer;\r\n      const zip = new JSZip();\r\n\r\n      await zip.loadAsync(zipArrayBuffer);\r\n\r\n      const token = window.adobeIMS?.getTokenFromStorage()?.token;\r\n      const options = {\r\n        method: 'GET',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          Authorization: 'Bearer ' + token,\r\n          'x-api-key': window?.adobeIMS?.adobeIdData?.client_id,\r\n        },\r\n      };\r\n\r\n      const response = await fetch(downloadAPI, options);\r\n\r\n      if (response.status === 200) {\r\n        const credential = await response.json();\r\n\r\n        zip.file('credential.json', JSON.stringify(credential));\r\n\r\n        const modifiedZipBlob = await zip.generateAsync({ type: 'blob' });\r\n        saveAs(modifiedZipBlob, `${fileName}.zip`);\r\n      } else {\r\n        console.error('Failed to fetch additional data. Response status:', response.status);\r\n      }\r\n    } catch (error) {\r\n      console.error('An error occurred:', error);\r\n    } finally {\r\n      setIsDownloadStart(false);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div\r\n      className={classNames(card?.className)}\r\n      css={css`\r\n        display: flex;\r\n        flex-direction: column;\r\n        gap: 48px;\r\n      `}>\r\n      <div\r\n        className={classNames(card?.className)}\r\n        css={css`\r\n          display: flex;\r\n          flex-direction: column;\r\n          gap: 16px;\r\n          color: var(--spectrum-global-color-gray-800);\r\n          width: 100%;\r\n          height: 100%;\r\n          text-align: left;\r\n\r\n          @media screen and (min-width: ${MIN_MOBILE_WIDTH}) and (max-width: ${MAX_TABLET_SCREEN_WIDTH}) {\r\n            padding: 0;\r\n            width: 100%;\r\n          }\r\n        `}>\r\n        <div\r\n          css={css`\r\n            display: flex;\r\n            gap: 20px;\r\n            align-items: baseline;\r\n          `}>\r\n          {card?.title && (\r\n            <h2\r\n              className=\"spectrum-Heading spectrum-Heading--sizeL\"\r\n              css={css`\r\n                font-weight: 700;\r\n                color: var(--spectrum-global-color-gray-900);\r\n              `}>\r\n              {card?.title}\r\n            </h2>\r\n          )}\r\n          {isDownloadStart && (\r\n            <div\r\n              css={css`\r\n                display: flex;\r\n                text-align: center;\r\n                align-items: center;\r\n                gap: 10px;\r\n              `}>\r\n              <div className=\"spectrum-ProgressCircle spectrum-ProgressCircle--indeterminate spectrum-ProgressCircle--small\">\r\n                <div className=\"spectrum-ProgressCircle-track\"></div>\r\n                <div className=\"spectrum-ProgressCircle-fills\">\r\n                  <div className=\"spectrum-ProgressCircle-fillMask1\">\r\n                    <div className=\"spectrum-ProgressCircle-fillSubMask1\">\r\n                      <div className=\"spectrum-ProgressCircle-fill\"></div>\r\n                    </div>\r\n                  </div>\r\n                  <div className=\"spectrum-ProgressCircle-fillMask2\">\r\n                    <div className=\"spectrum-ProgressCircle-fillSubMask2\">\r\n                      <div className=\"spectrum-ProgressCircle-fill\"></div>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <p\r\n                css={css`\r\n                  margin: 0;\r\n                `}>\r\n                Downloading...\r\n              </p>\r\n            </div>\r\n          )}\r\n        </div>\r\n        {formData['Downloads'] && card?.paragraph && (\r\n          <p\r\n            className=\"spectrum-Body spectrum-Body--sizeL\"\r\n            css={css`\r\n              color: var(--spectrum-global-color-gray-900);\r\n            `}>\r\n            {card?.paragraph}\r\n          </p>\r\n        )}\r\n        {formData['Downloads'] && (\r\n          <p\r\n            className=\"spectrum-Body spectrum-Body--sizeS\"\r\n            css={css`\r\n              color: var(--spectrum-global-color-gray-900);\r\n            `}>\r\n            Download not working?\r\n            <button\r\n              css={css`\r\n                padding: 0;\r\n                font-family: 'adobe-clean';\r\n                border: none;\r\n                background: transparent;\r\n                margin-left: 10px;\r\n                cursor: pointer;\r\n                text-decoration: underline;\r\n                color: rgb(0, 84, 182);\r\n                &:hover {\r\n                  color: rgb(2, 101, 220);\r\n                }\r\n              `}\r\n              onClick={() =>\r\n                downloadZIP(\r\n                  `/console/api/organizations/${organizationName?.id}/projects/${response.projectId}/workspaces/${response.workspaceId}/download`,\r\n                  formData['Download'],\r\n                  formData['zipUrl']\r\n                )\r\n              }\r\n              data-cy=\"restart-download\">\r\n              Restart download\r\n            </button>\r\n          </p>\r\n        )}\r\n      </div>\r\n      <div\r\n        css={css`\r\n          display: flex;\r\n          gap: 35px;\r\n\r\n          @media screen and (min-width: ${MIN_MOBILE_WIDTH}) and (max-width: ${MAX_TABLET_SCREEN_WIDTH}) {\r\n            flex-direction: column;\r\n            padding-left: 0;\r\n          }\r\n        `}>\r\n        <div\r\n          css={css`\r\n            display: flex;\r\n            flex-direction: column;\r\n            gap: 35px;\r\n            width: 50%;\r\n\r\n            @media screen and (min-width: ${MIN_MOBILE_WIDTH}) and (max-width: ${MAX_TABLET_SCREEN_WIDTH}) {\r\n              width: 100%;\r\n            }\r\n          `}>\r\n          <CredentialDetailsCard\r\n            credentialName={formData['CredentialName']}\r\n            productList={product}\r\n            ProductComponent={CardProducts}\r\n            AccessTokenComponent={AccessToken}\r\n            DevConsoleLinkComponent={DevConsoleLink}\r\n            ClientDetailsComponent={CardClientDetails}\r\n            allowedOriginsDetails={formData['AllowedOrigins']}\r\n            organizationName={organizationName}\r\n            response={response}\r\n            nextButtonLink={card?.nextStepsHref}\r\n            nextButtonLabel={card?.nextStepsLabel}\r\n            devConsoleLink={card?.devConsoleDirection}\r\n            developerConsoleManage={card?.developerConsoleManage}\r\n            myCredentialFields={myCredentialFields}\r\n          />\r\n          <div\r\n            css={css`\r\n              display: flex;\r\n              flex-direction: column;\r\n              gap: 8px;\r\n              width: 80%;\r\n            `}>\r\n            <h4\r\n              className=\"spectrum-Heading spectrum-Heading--sizeXS\"\r\n              css={css`\r\n                font-weight: 700;\r\n                color: var(--spectrum-global-color-gray-900);\r\n              `}>\r\n              Need another credential\r\n            </h4>\r\n            <p className=\"spectrum-Body spectrum-Body--sizeS\">\r\n              <button\r\n                onClick={handleRestart}\r\n                css={css`\r\n                  border: none;\r\n                  padding: 0;\r\n                  font-family: 'adobe-clean';\r\n                  background: transparent;\r\n                  color: var(--spectrum-global-color-gray-800);\r\n                  text-decoration: underline;\r\n                  cursor: pointer;\r\n                  &:hover {\r\n                    color: var(--spectrum-global-color-gray-900);\r\n                  }\r\n                `} data-cy=\"Restart-new-credential\">\r\n                Restart and create a new credential\r\n              </button>\r\n            </p>\r\n          </div>\r\n        </div>\r\n        {card?.children ? (\r\n          <SideContent\r\n            sideContent={myCredentialFields[SideComponent]?.children}\r\n            SideComp={SideComponent}\r\n          />\r\n        ) : null}\r\n      </div>\r\n      {isCopiedTooltip && (\r\n        <Toast\r\n          variant=\"success\"\r\n          message=\"Copied to clipboard\"\r\n          disable={1000}\r\n          customDisableFunction={setCopiedTooltip}\r\n        />\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport { MyCredential };\r\n"],"names":["MyCredential","formData","response","handleRestart","useContext","GetCredentialContext","getCredentialData","organizationName","selectedOrganization","credentialProps","useState","isDownloadStart","setIsDownloadStart","isCopiedTooltip","setCopiedTooltip","myCredentialFields","productsObj","label","productList","children","forEach","type","props","CardClientDetails","CardProducts","push","concat","map","icon","product","useEffect","downloadZIP","id","projectId","workspaceId","card","downloadAPI","fileName","zipFileURL","JSZipUtils","zipData","zipArrayBuffer","Uint8Array","buffer","zip","JSZip","loadAsync","token","window","adobeIMS","getTokenFromStorage","options","method","headers","Authorization","adobeIdData","client_id","fetch","status","json","credential","file","JSON","stringify","generateAsync","modifiedZipBlob","saveAs","console","error","className","classNames","css","MIN_MOBILE_WIDTH","MAX_TABLET_SCREEN_WIDTH","title","paragraph","onClick","credentialName","ProductComponent","AccessTokenComponent","AccessToken","DevConsoleLinkComponent","DevConsoleLink","ClientDetailsComponent","allowedOriginsDetails","nextButtonLink","nextStepsHref","nextButtonLabel","nextStepsLabel","devConsoleLink","devConsoleDirection","developerConsoleManage","sideContent","SideComponent","SideComp","variant","message","disable","customDisableFunction"],"sourceRoot":""}