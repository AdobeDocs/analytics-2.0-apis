(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[8319],{7589:function(e,n,t){"use strict";t.r(n),t.d(n,{_frontmatter:function(){return m},default:function(){return c}});var a,i=t(22122),r=t(19756),d=(t(15007),t(64983)),l=t(99536),o=["components"],m={},s=(a="CodeBlock",function(e){return console.warn("Component "+a+" was not imported, exported, or provided by MDXProvider as global scope"),(0,d.mdx)("div",e)}),p={_frontmatter:m},u=l.Z;function c(e){var n=e.components,t=(0,r.Z)(e,o);return(0,d.mdx)(u,(0,i.Z)({},p,t,{components:n,mdxType:"MDXLayout"}),(0,d.mdx)("h1",{id:"bulk-data-insertion-api-endpoints"},"Bulk Data Insertion API endpoints"),(0,d.mdx)("p",null,"Once you have met all ",(0,d.mdx)("a",{parentName:"p",href:"index.md"},"prerequisites")," and have a ",(0,d.mdx)("a",{parentName:"p",href:"file-format.md"},"correctly formatted file"),", you can begin making API calls to Adobe's endpoints for this API."),(0,d.mdx)("h2",{id:"primary-ingestion-endpoint"},"Primary ingestion endpoint"),(0,d.mdx)("p",null,"Once you have ",(0,d.mdx)("a",{parentName:"p",href:"#validate"},"validated")," your file, you can use this endpoint to send it to Adobe for ingestion."),(0,d.mdx)("p",null,(0,d.mdx)("inlineCode",{parentName:"p"},"POST https://analytics-collection.adobe.io/aa/collect/v1/events")),(0,d.mdx)("p",null,"Include all of the required headers with each API call:"),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},(0,d.mdx)("inlineCode",{parentName:"strong"},"Authorization")),": Required for authentication with the API. Format is the string ",(0,d.mdx)("inlineCode",{parentName:"li"},'"Bearer {ACCESS_TOKEN}'),"."),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},(0,d.mdx)("inlineCode",{parentName:"strong"},"x-api-key")),": Required for authentication with the API. Found in the Adobe I/O console under the JWT service credentials."),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},(0,d.mdx)("inlineCode",{parentName:"strong"},"x-adobe-vgid")),": Required for this endpoint. The visitor group ID. See ",(0,d.mdx)("a",{parentName:"li",href:"visitor-groups.md"},"Visitor groups"),"."),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},(0,d.mdx)("inlineCode",{parentName:"strong"},"x-adobe-idempotency-key")),": Optional. Allows you to manually specify the ",(0,d.mdx)("inlineCode",{parentName:"li"},"file_id")," of the file contained in the API call. If you do not send this header, Adobe automatically generates a ",(0,d.mdx)("inlineCode",{parentName:"li"},"file_id")," for you and includes it in the response JSON object.")),(0,d.mdx)("p",null,"You must also include the file in your API call in gzip format."),(0,d.mdx)("p",null,"The ",(0,d.mdx)("inlineCode",{parentName:"p"},"https://analytics-collection.adobe.io")," domain automatically routes your API call to the best region for processing. However, if you are legally required to have your data processed in a specific part of the world, you can use one of the following host names for API calls:"),(0,d.mdx)("ul",null,(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"US processing"),": ",(0,d.mdx)("inlineCode",{parentName:"li"},"https://analytics-collection-va7.adobe.io")),(0,d.mdx)("li",{parentName:"ul"},(0,d.mdx)("strong",{parentName:"li"},"European processing"),": ",(0,d.mdx)("inlineCode",{parentName:"li"},"https://analytics-collection-nld2.adobe.io"))),(0,d.mdx)(s,{slots:"heading, code",repeat:"5",languages:"CURL,JSON",mdxType:"CodeBlock"}),(0,d.mdx)("h4",{id:"request"},"Request"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-sh"},'curl -X GET -H "accept: application/json" \\\n    -H "Authorization: Bearer {ACCESS_TOKEN}" \\\n    -H "x-api-key: {API_KEY/CLIENT_ID}" \\\n    -H "x-adobe-vgid: example_group" \\\n    -F file=@/tmp/ingest_file.gz \\\n    "https://analytics-collection.adobe.io/aa/collect/v1/events"\n')),(0,d.mdx)("h4",{id:"success-response"},"Success response"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "file_id": "5c04f400-fca5-420c-9c36-b94aaec55e69",\n  "visitor_group_id": "example_group",\n  "size": 355600,\n  "received_date": 1506553535,\n  "processing_start_date": 1506553492,\n  "processing_end_date": 1506553492,\n  "file_reader_complete_date": 1506553492,\n  "rows": 10000,\n  "invalid_rows": 42,\n  "upload_name": "ingest_file.gz",\n  "status": "string",\n  "status_code": "UPLOADED",\n  "processing_log": "string",\n  "success": "File is valid"\n}\n')),(0,d.mdx)("h4",{id:"failure-response---missing-visitor-group"},"Failure response - missing visitor group"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "error": "Request is missing required header \'x-adobe-vgid\'"\n}\n')),(0,d.mdx)("h4",{id:"failure-response---incorrect-file-format"},"Failure response - incorrect file format"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "error": "CSV file missing required header \'timestamp\'."\n}\n')),(0,d.mdx)("h4",{id:"failure-response---incorrect-credentials"},"Failure response - incorrect credentials"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "error": "Token validation failed"\n}\n')),(0,d.mdx)("h3",{id:"response-object-details"},"Response object details"),(0,d.mdx)("p",null,"When you upload a file to this endpoint, Adobe returns a JSON object that can contain the following fields:"),(0,d.mdx)("table",null,(0,d.mdx)("thead",{parentName:"table"},(0,d.mdx)("tr",{parentName:"thead"},(0,d.mdx)("th",{parentName:"tr",align:null},"Field"),(0,d.mdx)("th",{parentName:"tr",align:null},"Data type"),(0,d.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,d.mdx)("tbody",{parentName:"table"},(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"file_id")),(0,d.mdx)("td",{parentName:"tr",align:null},"string"),(0,d.mdx)("td",{parentName:"tr",align:null},"Unique identifier for the file upload transaction. Automatically generated by Adobe unless you include the ",(0,d.mdx)("inlineCode",{parentName:"td"},"x-adobe-idempotency-key")," header in the API call.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"visitor_group")),(0,d.mdx)("td",{parentName:"tr",align:null},"string"),(0,d.mdx)("td",{parentName:"tr",align:null},"Name of the visitor group as stated in the ",(0,d.mdx)("inlineCode",{parentName:"td"},"x-adobe-vgid")," header. See ",(0,d.mdx)("a",{parentName:"td",href:"visitor-groups.md"},"Visitor groups"),".")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"size")),(0,d.mdx)("td",{parentName:"tr",align:null},"long"),(0,d.mdx)("td",{parentName:"tr",align:null},"The size of the uploaded file in bytes.")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"received_date")),(0,d.mdx)("td",{parentName:"tr",align:null},"long"),(0,d.mdx)("td",{parentName:"tr",align:null},"The Unix timestamp when the file was received")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"rows")),(0,d.mdx)("td",{parentName:"tr",align:null},"integer"),(0,d.mdx)("td",{parentName:"tr",align:null},"The number of rows contained in the file")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"invalid_rows")),(0,d.mdx)("td",{parentName:"tr",align:null},"integer"),(0,d.mdx)("td",{parentName:"tr",align:null},"The number of invalid rows identified in the file")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"upload_name")),(0,d.mdx)("td",{parentName:"tr",align:null},"string"),(0,d.mdx)("td",{parentName:"tr",align:null},"The name of the file included in the request")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"status_code")),(0,d.mdx)("td",{parentName:"tr",align:null},"string"),(0,d.mdx)("td",{parentName:"tr",align:null},"The status of the file upload. Valid values include ",(0,d.mdx)("inlineCode",{parentName:"td"},"UPLOADED")," or ",(0,d.mdx)("inlineCode",{parentName:"td"},"REJECTED"),".")),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"status")),(0,d.mdx)("td",{parentName:"tr",align:null},"string"),(0,d.mdx)("td",{parentName:"tr",align:null},"More verbose details around the ",(0,d.mdx)("inlineCode",{parentName:"td"},"status_code"))),(0,d.mdx)("tr",{parentName:"tbody"},(0,d.mdx)("td",{parentName:"tr",align:null},(0,d.mdx)("inlineCode",{parentName:"td"},"processing_log")),(0,d.mdx)("td",{parentName:"tr",align:null},"string"),(0,d.mdx)("td",{parentName:"tr",align:null},"Details around specific issues encountered. If an error type has 10 or less problem rows, they are explicitly mentioned. If an error type has more than 10 problem rows, summarized results are provided.")))),(0,d.mdx)("h2",{id:"validate"},"Validate"),(0,d.mdx)("p",null,"Before uploading your first file, Adobe strongly recommends running the file through the validation endpoint. This endpoint exists to test files before you upload them to the ",(0,d.mdx)("inlineCode",{parentName:"p"},"events")," endpoint. Files uploaded to this endpoint are not stored on Adobe's servers or processed. This API is synchronous and returns an immediate reply that states the file's validation status. If a file fails validation, the reason is also returned. See ",(0,d.mdx)("a",{parentName:"p",href:"troubleshooting.md"},"Troubleshoot uploads")," for more information."),(0,d.mdx)("p",null,(0,d.mdx)("inlineCode",{parentName:"p"},"POST https://analytics-collection.adobe.io/aa/collect/v1/events/validate")),(0,d.mdx)(s,{slots:"heading, code",repeat:"3",languages:"CURL,JSON",mdxType:"CodeBlock"}),(0,d.mdx)("h4",{id:"request-1"},"Request"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-sh"},'curl -X GET -H "accept: application/json" \\\n    -H "x-proxy-global-company-id: {ANALYTICS_GLOBAL_COMPANY_ID}" \\\n    -H "Authorization: Bearer {ACCESS_TOKEN}" \\\n    -H "x-api-key: {API_KEY/CLIENT_ID}" \\\n    -F file=@/tmp/ingest_file.gz \\\n    "https://analytics.adobe.io/aa/collect/v1/events/validate"\n')),(0,d.mdx)("h4",{id:"success-response-1"},"Success response"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "success": "file is valid"\n}\n')),(0,d.mdx)("h4",{id:"failure-response---invalid-rows"},"Failure response - invalid rows"),(0,d.mdx)("pre",null,(0,d.mdx)("code",{parentName:"pre",className:"language-json"},'{\n    "error": "File has 2 rows that do not conform to the required CSV format! (Ex: row #59)"\n}\n')))}c.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-endpoints-bulk-data-insertion-endpoints-md-32f69afedee0cf762c8c.js.map