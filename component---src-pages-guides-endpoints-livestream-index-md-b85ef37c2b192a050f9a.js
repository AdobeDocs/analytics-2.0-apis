"use strict";(self.webpackChunkanalytics_2_0_apis=self.webpackChunkanalytics_2_0_apis||[]).push([[8297],{14795:function(e,t,a){a.r(t),a.d(t,{_frontmatter:function(){return d},default:function(){return c}});var n=a(58168),o=a(98587),i=(a(36190),a(28619)),r=a(83407),s=["components"],d={},l={_frontmatter:d},m=r.A;function c(e){var t=e.components,a=(0,o.A)(e,s);return(0,i.mdx)(m,(0,n.A)({},l,a,{components:t,mdxType:"MDXLayout"}),(0,i.mdx)("h1",{id:"getting-started-with-adobe-analytics-livestream"},"Getting started with Adobe Analytics Livestream"),(0,i.mdx)("p",null,"Livestream is a reporting feature in Adobe Analytics that allows a client to receive traffic processed by Adobe Analytics in real-time. Traffic is streamed to the client on a hit or impression basis, in the same order and rate that hits are processed."),(0,i.mdx)("p",null,"This feature is useful for those building:"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"A real-time dashboard that represents actions visitors are taking in a mobile app or web site."),(0,i.mdx)("li",{parentName:"ul"},"A visitor-level integration that sends information to personalization or marketing platforms in real-time."),(0,i.mdx)("li",{parentName:"ul"},"A forecasting or anomaly detection service that updates a model and produces forecasts/anomaly reports in real-time.")),(0,i.mdx)("h2",{id:"create-an-adobe-developer-console-account"},"Create an Adobe Developer Console account"),(0,i.mdx)("p",null,"To start, create an ",(0,i.mdx)("a",{parentName:"p",href:"https://www.adobe.io/authentication/auth-methods.html#!AdobeDocs/adobeio-auth/master/AuthenticationOverview/ServiceAccountIntegration.md"},"Adobe Developer Console")," account. This account provides the credentials to authenticate and connect to the stream. After creating this account, make a note of the ",(0,i.mdx)("strong",{parentName:"p"},"Technical Account Email"),". This email is used later to link the service account to a Livestream endpoint."),(0,i.mdx)("h2",{id:"identify-and-understand-the-data-structure-for-the-stream"},"Identify and understand the data structure for the stream"),(0,i.mdx)("p",null,"Review the list of ",(0,i.mdx)("a",{parentName:"p",href:"variable-reference.md"},"dimensions and metrics")," to identify and understand the data structure for the stream. The stream sends a new object in response to a GET call every time a report suite receives another hit. The stream outputs all applicable dimensions and metrics for the report suite. "),(0,i.mdx)("h2",{id:"contact-customer-care-to-provision-the-stream"},"Contact Customer Care to provision the stream"),(0,i.mdx)("p",null,(0,i.mdx)("a",{parentName:"p",href:"https://helpx.adobe.com/contact.html"},"Customer Care")," requires all of the following information to provision the stream:"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"Data center location (London, Pacific North West, Singapore)"),(0,i.mdx)("li",{parentName:"ul"},"Login company or IMS organization"),(0,i.mdx)("li",{parentName:"ul"},"A report suite ID for each stream requested and for which data is being generated"),(0,i.mdx)("li",{parentName:"ul"},"Estimated daily and monthly traffic volume averages"),(0,i.mdx)("li",{parentName:"ul"},"The ",(0,i.mdx)("a",{parentName:"li",href:"https://developer.adobe.com/console/home"},"Adobe Developer Console")," technical account email address")),(0,i.mdx)("h2",{id:"create-an-application-to-consume-the-api-service"},"Create an application to consume the API service"),(0,i.mdx)("p",null,"Depending on the use case for your stream, create an application for the service. This application should include the business logic you want to use. "),(0,i.mdx)("h3",{id:"decouple-consumption-from-processing"},"Decouple consumption from processing"),(0,i.mdx)("p",null,"To avoid data bottlenecks, Adobe recommends using a client that decouples consumption from processing. You can implement this with the following methods:"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"Use example Java code that includes those features, as referenced in sections below."),(0,i.mdx)("li",{parentName:"ul"},"Use buffers."),(0,i.mdx)("li",{parentName:"ul"},"Cache the data."),(0,i.mdx)("li",{parentName:"ul"},"Use queues and delegate work to another thread, or write to a data queue like Apache Kafka. The example Java client described below incorportes this with the following lines of code:")),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-java"},"String line = reader.readLine();\n        while (line != null) {\n            dataQueue.put(line);\n            line = reader.readLine();\n        }\n")),(0,i.mdx)("h4",{id:"example-java-based-client"},"Example Java-based client"),(0,i.mdx)("p",null,"For example code of a client that decouples consumption and processing, you can view and copy the ",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/AdobeDocs/analytics-2.0-apis/blob/main/resources/java/livestream/LivestreamConsumer.java"},"LivestreamConsumer.java file"),". The example code includes annotations to describe the functions of the code. Adobe also provides ",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/AdobeDocs/analytics-2.0-apis/blob/main/resources/java/livestream/pom.xml"},"XML-based resources")," for implementing this configuration. "),(0,i.mdx)("h4",{id:"handling-redirects"},"Handling redirects"),(0,i.mdx)("p",null,"Many client libraries remove the Authorization header on a redirect. The example ",(0,i.mdx)("a",{parentName:"p",href:"https://github.com/AdobeDocs/analytics-2.0-apis/blob/main/resources/java/livestream/LivestreamConsumer.java#L66-L70"},(0,i.mdx)("inlineCode",{parentName:"a"},"LivestreamConsumer.java"))," shows how to handle redirects manually to avoid this issue, including the following lines"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-java"},' private HttpURLConnection getConnection(final String streamUrl, final String accessToken) throws IOException {\n        URL url = new URL(streamUrl);\n        HttpURLConnection connection = (HttpURLConnection) url.openConnection();\n        connection.setReadTimeout((int) Duration.ofSeconds(60).toMillis());\n        connection.setConnectTimeout((int) Duration.ofSeconds(10).toMillis());\n\n        connection.setRequestProperty("Accept-Encoding", "gzip");\n        connection.setRequestProperty("Authorization", "Bearer " + accessToken);\n\n        connection.setInstanceFollowRedirects(false);\n\n        return connection;\n')),(0,i.mdx)("h2",{id:"connect-to-the-stream"},"Connect to the stream"),(0,i.mdx)("p",null,"To connect to the steam, make a request that looks similar to the following:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-curl"},'curl -X GET "https://livestream.adobe.net/api/1/stream/adobe-livestream-{endpoint-name}" \\\n    -H "x-api-key: {CLIENTID}" \\\n    -H "Authorization: Bearer {ACCESSTOKEN}" \\\n    --location-trusted \\\n    --compressed\n')),(0,i.mdx)("p",null,"When contacting Customer Care for provisioning, you will receive the complete URI to connect to the stream, including the ",(0,i.mdx)("inlineCode",{parentName:"p"},"{endpoint-name}"),", as shown in the example above. The URI will also include the report suite ID that you supply to Customer Care. "),(0,i.mdx)("h2",{id:"review-the-stream-output"},"Review the stream output"),(0,i.mdx)("p",null,"Once connected to the stream, impression data is streamed with ",(0,i.mdx)("a",{parentName:"p",href:"https://www.gnu.org/software/gzip/manual/gzip.html"},"Gzip compression")," (",(0,i.mdx)("strong",{parentName:"p"},(0,i.mdx)("inlineCode",{parentName:"strong"},".gz")),") in JSON format and reflects data currently collected by the report suite. Data is See ",(0,i.mdx)("a",{parentName:"p",href:"example-output.md"},"Livestream sample JSON output")," to view a sample of a typical response."),(0,i.mdx)("p",null,"If there is no data actively flowing into the report suite, the client connects but no data appears in the stream."),(0,i.mdx)("h2",{id:"use-optional-query-parameters"},"Use optional query parameters"),(0,i.mdx)("p",null,"You can also include query string parameters in your call, as described below:"),(0,i.mdx)("table",null,(0,i.mdx)("thead",{parentName:"table"},(0,i.mdx)("tr",{parentName:"thead"},(0,i.mdx)("th",{parentName:"tr",align:null},"Query parameter"),(0,i.mdx)("th",{parentName:"tr",align:null},"Description"))),(0,i.mdx)("tbody",{parentName:"table"},(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("strong",{parentName:"td"},(0,i.mdx)("inlineCode",{parentName:"strong"},"maxConnections"))),(0,i.mdx)("td",{parentName:"tr",align:null},"Allows the distribution of hits across multiple clients. This number determines the maximum number of clients that can connect to the same stream. Valid values include ",(0,i.mdx)("inlineCode",{parentName:"td"},"1")," through ",(0,i.mdx)("inlineCode",{parentName:"td"},"8"),".")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("strong",{parentName:"td"},(0,i.mdx)("inlineCode",{parentName:"strong"},"reset"))),(0,i.mdx)("td",{parentName:"tr",align:null},"The age of data to return during the initial connection/reconnection. Valid values include ",(0,i.mdx)("inlineCode",{parentName:"td"},"smallest")," (streams the oldest possible data) and ",(0,i.mdx)("inlineCode",{parentName:"td"},"largest")," (streams the newest possible data).")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("strong",{parentName:"td"},(0,i.mdx)("inlineCode",{parentName:"strong"},"smoothing"))),(0,i.mdx)("td",{parentName:"tr",align:null},"Smooths the rate of records returned by Livestream using a server-side buffer. Disabled by default; set to ",(0,i.mdx)("inlineCode",{parentName:"td"},"1")," to enable smoothing.")),(0,i.mdx)("tr",{parentName:"tbody"},(0,i.mdx)("td",{parentName:"tr",align:null},(0,i.mdx)("strong",{parentName:"td"},(0,i.mdx)("inlineCode",{parentName:"strong"},"smoothingBucketSize"))),(0,i.mdx)("td",{parentName:"tr",align:null},"The size of the time window, in seconds, that determines the average traffic rate used in smoothing. Supported values include integers between ",(0,i.mdx)("inlineCode",{parentName:"td"},"1")," and ",(0,i.mdx)("inlineCode",{parentName:"td"},"7200"),". The default is ",(0,i.mdx)("inlineCode",{parentName:"td"},"270")," seconds. If ",(0,i.mdx)("inlineCode",{parentName:"td"},"smoothing")," is omitted, this parameter does nothing.")))),(0,i.mdx)("h2",{id:"additional-notes"},"Additional notes"),(0,i.mdx)("ul",null,(0,i.mdx)("li",{parentName:"ul"},"Your site must support redirects to receive the output."),(0,i.mdx)("li",{parentName:"ul"},"The output data in Livestream is already processed through ",(0,i.mdx)("a",{parentName:"li",href:"https://experienceleague.adobe.com/docs/analytics/technotes/vista.html"},"VISTA")," and processing rules."),(0,i.mdx)("li",{parentName:"ul"},"To refresh authentication tokens, see the ",(0,i.mdx)("a",{parentName:"li",href:"https://developer.adobe.com/developer-console/docs/guides/authentication/UserAuthentication/IMS/#refreshing-access-tokens"},"Authentication Guide."))))}c.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-endpoints-livestream-index-md-b85ef37c2b192a050f9a.js.map