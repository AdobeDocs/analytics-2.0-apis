(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[5529],{237:function(e,n,a){"use strict";a.r(n),a.d(n,{_frontmatter:function(){return l},default:function(){return s}});var t=a(22122),o=a(19756),i=(a(15007),a(64983)),m=a(99536),r=["components"],l={},p={_frontmatter:l},d=m.Z;function s(e){var n=e.components,a=(0,o.Z)(e,r);return(0,i.mdx)(d,(0,t.Z)({},p,a,{components:n,mdxType:"MDXLayout"}),(0,i.mdx)("h1",{id:"use-curl-with-the-analytics-20-api"},"Use cURL with the Analytics 2.0 API"),(0,i.mdx)("p",null,"To obtain Oauth authentication using cURL:"),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},"Get an auth code."),(0,i.mdx)("li",{parentName:"ol"},"Generate an access token."),(0,i.mdx)("li",{parentName:"ol"},"Test your access token.")),(0,i.mdx)("h2",{id:"get-an-auth-code"},"Get an auth code"),(0,i.mdx)("p",null,"Use the following model as a cURL request for an auth code:"),(0,i.mdx)("p",null,(0,i.mdx)("inlineCode",{parentName:"p"},"https://ims-na1.adobelogin.com/ims/authorize?client_id={CLIENT ID}&redirect_uri={REDIRECT URI}&scope=openid,AdobeID,read_organizations,additional_info.job_function,additional_info.projectedProductContext&response_type=code")),(0,i.mdx)("p",null,"To get an auth code:"),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},"Copy the Client ID from your OAuth client and paste it into the ",(0,i.mdx)("inlineCode",{parentName:"li"},"{CLIENT ID}")," placeholder in the URI above."),(0,i.mdx)("li",{parentName:"ol"},"Replace ",(0,i.mdx)("inlineCode",{parentName:"li"},"{REDIRECT URI}")," with the redirect URI you specified when creating the client."),(0,i.mdx)("li",{parentName:"ol"},"Paste the complete URI into your favorite browser."),(0,i.mdx)("li",{parentName:"ol"},"After authenticating via IMS, copy the auth code query parameter in the URI (the parameter begins with ",(0,i.mdx)("inlineCode",{parentName:"li"},"code=eyJ4..."),").")),(0,i.mdx)("h2",{id:"generate-an-access-token"},"Generate an access token"),(0,i.mdx)("p",null,"Use the following model to generate an access token:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-sh"},'curl --data "grant_type=authorization_code&client_id={CLIENT ID}&client_secret={CLIENT SECRET}&code={AUTH CODE QUERY PARAMETER}" https://ims-na1.adobelogin.com/ims/token/v1\n')),(0,i.mdx)("p",null,"To generate an access token:"),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Replace ",(0,i.mdx)("inlineCode",{parentName:"p"},"{AUTH CODE QUERY PARAMETER}")," with the auth code you copied from the previous step in the above cURL request.")),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Replace ",(0,i.mdx)("inlineCode",{parentName:"p"},"{CLIENT ID}")," in the above request with the Client ID from your Oauth client.")),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Replace ",(0,i.mdx)("inlineCode",{parentName:"p"},"{CLIENT SECRET}")," in the above request with the Client Secret from your Oauth client.")),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Run the cURL command. The response includes an ",(0,i.mdx)("inlineCode",{parentName:"p"},"access_token")," attribute, as shown below:"),(0,i.mdx)("pre",{parentName:"li"},(0,i.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "account_type": "type1",\n  "utcOffset": "null",\n  "preferred_languages": [\n    "en-us"\n  ],\n  "projectedProductContext": [\n    {\n      "prodCtx": {\n        "serviceCode": "dma_analytics",\n        "global_company_id": "testco0",\n        "login_company": "Test Company",\n        ...\n      }\n    },\n    ...\n  ],\n  "displayName": "James Ross",\n  "last_name": "Ross",\n  "token_type": "bearer",\n  "userId": "JAMESROSS@AdobeID",\n  "access_token": "eyJ4...TOKEN_OMITTED",\n  "refresh_token": "eyJ4...TOKEN_OMITTED",\n  "emailVerified": "true",\n  "phoneNumber": null,\n  "countryCode": "US",\n  "name": "Bob Ross",\n  "mrktPerm": "EMAIL:false",\n  "mrktPermEmail": "false",\n  "expires_in": 86399988,\n  "first_name": "James",\n  "email": "test@adobe.com",\n  ...\n}\n')),(0,i.mdx)("p",{parentName:"li"},(0,i.mdx)("em",{parentName:"p"},"Note: If you have access to numerous product profiles, the response can be very large. If it is so large that the ",(0,i.mdx)("inlineCode",{parentName:"em"},"access_token")," is truncated from the response, you can write it to a file in order to find your access token. To write the response to a file, add ",(0,i.mdx)("inlineCode",{parentName:"em"},">> output.json")," to the end of your cURL request. The response is then written to a file named ",(0,i.mdx)("inlineCode",{parentName:"em"},"output.json"),"."))),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Copy the access token to test it in the following section."))),(0,i.mdx)("h2",{id:"test-your-access-token-by-calling-the-analytics-apis"},"Test your access token by calling the Analytics APIs"),(0,i.mdx)("p",null,"To test your access token:"),(0,i.mdx)("pre",null,(0,i.mdx)("code",{parentName:"pre",className:"language-sh"},'curl -X GET --header "Accept: application/json" --header "x-api-key: {CLIENT ID}" --header "Authorization: Bearer {ACCESS_TOKEN}" "https://analytics.adobe.io/discovery/me"\n')),(0,i.mdx)("ol",null,(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Replace ",(0,i.mdx)("inlineCode",{parentName:"p"},"{ACCESS_TOKEN}")," with the access token you copied from the previous step into the above cURL request.")),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Replace ",(0,i.mdx)("inlineCode",{parentName:"p"},"{CLIENT ID}")," in the above request with the client ID from your Oauth client.")),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Run the cURL command. The following JSON shows an example response:"),(0,i.mdx)("pre",{parentName:"li"},(0,i.mdx)("code",{parentName:"pre",className:"language-json"},'{\n  "imsUserId": "1B..OMITTED..01@AdobeID",\n  "imsOrgs": [\n    {\n      "imsOrgId": "EA..OMITTED..29@AdobeOrg",\n      "companies": [\n        {\n          "globalCompanyId": "testco0",\n          "companyName": "Test Company",\n          "apiRateLimitPolicy": "aa_api_tier10_tp"\n        },\n        {\n          "globalCompanyId": "anothe0",\n          "companyName": "Another Test Company",\n          "apiRateLimitPolicy": "aa_api_tier10_tp"\n        }\n      ]\n    },\n    ...\n  ]\n}\n'))),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Use the ",(0,i.mdx)("inlineCode",{parentName:"p"},"globalCompanyId")," value in your response (in the above example, it is shown as ",(0,i.mdx)("inlineCode",{parentName:"p"},"testco0"),") to test the ",(0,i.mdx)("inlineCode",{parentName:"p"},"GET /users/me")," endpoint. To do this, replace the ",(0,i.mdx)("inlineCode",{parentName:"p"},"{GLOBAL COMPANY ID}")," parameters in the following request with their corresponding values. Note that ",(0,i.mdx)("inlineCode",{parentName:"p"},"{GLOBAL COMPANY ID}")," occurs twice in the following request, once in the ",(0,i.mdx)("inlineCode",{parentName:"p"},"x-proxy-company-global-company-id")," header and another in the path:"),(0,i.mdx)("pre",{parentName:"li"},(0,i.mdx)("code",{parentName:"pre",className:"language-sh"},'curl -X GET  --header "Authorization: Bearer {ACCESS_TOKEN}" --header "x-proxy-global-company-id: {COMPANY_ID}" --header "x-api-key: {CLIENT_ID}" "https://analytics.adobe.io/api/{COMPANY_ID}/users/me"\n'))),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Replace ",(0,i.mdx)("inlineCode",{parentName:"p"},"{ACCESS_TOKEN}")," and ",(0,i.mdx)("inlineCode",{parentName:"p"},"{CLIENT_ID}")," in the above request with their respective values.")),(0,i.mdx)("li",{parentName:"ol"},(0,i.mdx)("p",{parentName:"li"},"Run the cURL command. The response includes information about the analytics user."))),(0,i.mdx)("p",null,"Use your ",(0,i.mdx)("inlineCode",{parentName:"p"},"access token"),", ",(0,i.mdx)("inlineCode",{parentName:"p"},"global company id")," and ",(0,i.mdx)("inlineCode",{parentName:"p"},"client ID")," to make calls to the APIs. You can use the ",(0,i.mdx)("a",{parentName:"p",href:"../../apis/index.md"},"API reference")," as an easy way to explore calling the Analytics APIs."))}s.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-guides-use-cases-curl-md-53219d01e083c56ca581.js.map